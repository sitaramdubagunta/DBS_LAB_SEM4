
1. Find courses that ran in Fall 2009 or in Spring 2010 INTERSECT (Use intersect 
all to retain duplicates):  
select course_id from section where semester = 'Fall' and year = '2009'
  2  union all
  3  select course_id from section where semester = 'Spring' and year = 2010
  4  ;


2. Find courses that ran in Fall 2009 and in spring 2010 

select course_id from section where semester = 'Fall' and year= 2009
intersect 
select course_id from section where semester = 'Spring' and year=2010;

MINUS:  
3. Find courses that ran in Fall 2009 but not in Spring 2010  

select course_id from section where semester = 'Fall' and year= 2009
minus
select course_id from section where semester = 'Spring' and year=2010;

Null values  
4. Find the name of the course for which none of the students registered.


select course_id ,  title
from course
where course_id not in(select distinct course_id from takes);


5.  Find courses offered in Fall 2009 and in Spring 2010. 


select * from section where semester = 'Fall' and year  = 2009 
and course_id in ( select course_id from section where semester = 'Spring' and year = 2010);

6. Find the total number of students who have taken course taught by the instructor with 
ID 10101

select count(distinct ID) 
from takes 
where course_id in (select course_id from teaches where id = 10101);


7. Find courses offered in Fall 2009 but not in Spring 2010.  
select * from section where semester = 'Fall' and year  = 2009 
and course_id not in ( select course_id from section where semester = 'Spring' and year = 2010);

8. Find the names of all students whose name is same as the instructorâ€™s name.  

select name from student
where name in (select name from instructor);

9. Find names of instructors with salary greater than that of some (at least one) 
instructor in the Biology department.  


select name, salary 
from instructor
where salary > some(select salary from instructor where dept_name = 'Biology');


10. Find the names of all instructors whose salary is greater than the salary of all 
instructors in the Biology department

select name , salary
from instructor 
where salary > all(select salary from instructor where dept_name = 'Biology');

11. Find the departments that have the highest average salary.  


select dept_name ,avg(salary)
from instructor
group by dept_name
having avg(salary) >= all(
select avg(salary)
from instructor
group by dept_name);

12. Find the names of those departments whose budget is lesser than the average salary 
of all instructors. 

select dept_name , budget 
from department
where budget < (select AVG(salary) from instructor);


13. Find all courses taught in both the Fall 2009 semester and in the Spring 2010 
semester.  

select *
from section s
where s.year = 2009 and s.semester = 'Fall'
and exists(
	select * from section s2
	where s2.year = 2010  and s2.semester = 'Spring'
	and s2.course_id = s.course_id);

14. Find all students who have taken all courses offered in the Biology department.  




15. Find all courses that were offered at most once in 2009.  

select course_id  from section
where year = 2009
group by course_id
having count(*) <= 1;

16. Find all the students who have opted at least two courses offered by CSE department.

SELECT s.ID, s.name
FROM Student s
WHERE (
    SELECT COUNT(DISTINCT t.course_id)
    FROM Takes t
    WHERE t.ID = s.ID
      AND t.course_id IN (
          SELECT c.course_id
          FROM Course c
          WHERE c.dept_name = 'Comp. Sci.'
      )
) >= 2;



Subqueries in the From Clause  
17. Find the average instructors salary of those departments where the average salary is 
greater than 42000


select dept_name , avg_salary
from ( select dept_name , avg(salary) as avg_salary from instructor group by dept_name)
where avg_salary > 42000
